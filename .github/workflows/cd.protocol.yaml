name: "CD"

on:
  push:
    branches:
      - master
      - feature/ci-cd

jobs:
  # validate:
  #   uses: ./.github/workflows/validate.yaml
  #   with:
  #     target: "protocol/Irrelephant.Outcast.Protocol.sln"

  - name: Generate build number
    uses: einaregilsson/build-number@v2 
    with:
      token: ${{secrets.github_token}}
  - name: Print new build number
    run: echo "Build number is $BUILD_NUMBER"

  publish:
    # needs: validate
    uses: ./.github/workflows/nuget.publish.yaml
    with:
      target: "protocol/Irrelephant.Outcast.Protocol.sln"
      version: "0.0.${{ github.run_id }}"